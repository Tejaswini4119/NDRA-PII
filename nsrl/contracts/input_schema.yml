# NSRL Engine Input Contract
# Describes the data structure required to invoke the rules engine.

type: object
required:
  - requestId
  - object
  - context

properties:
  requestId:
    type: string
    description: "Unique UUID for tracing"
  
  object:
    type: object
    description: "The PII entity being evaluated"
    required:
      - value
      - type
      - confidence
    properties:
      value:
        type: string
        description: "The detected text detected (e.g., '123-45-6789')"
      type:
        type: string
        description: "Detector type (e.g., 'US_SSN', 'EMAIL_ADDRESS')"
      confidence:
        type: number
        minimum: 0.0
        maximum: 1.0
        description: "Detector confidence score"
      start:
        type: integer
        description: "Start offset in document"
      end:
        type: integer
        description: "End offset in document"

  context:
    type: object
    description: "Global metadata about the evaluation request"
    properties:
      sourceSystem:
        type: string
      documentType:
        type: string
      jurisdiction:
        type: string
      timestamp:
        type: string
        format: date-time
      
      # Aggregated Counters (Provided by upstream pre-processor)
      pii_total_count:
        type: integer
        default: 0
      
      # Aggregated Flags (Is this type present anywhere in the doc?)
      has_gov_id:
        type: boolean
        default: false
      has_financial_data:
        type: boolean
        default: false
      has_healthcare_data:
        type: boolean
        default: false
